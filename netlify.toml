[build]
  publish = "dist"
  command = "npm install && npm run build"

[build.environment]
  NODE_VERSION = "20"
  # Omit Firebase client-side config from secret scanning (these are public by design)
  # Also omit VITE_ENV which is just "production" or "development"
  SECRETS_SCAN_OMIT_KEYS = "VITE_ENV,VITE_FIREBASE_API_KEY,VITE_FIREBASE_AUTH_DOMAIN,VITE_FIREBASE_PROJECT_ID,VITE_FIREBASE_STORAGE_BUCKET,VITE_FIREBASE_MESSAGING_SENDER_ID,VITE_FIREBASE_APP_ID,VITE_FIREBASE_MEASUREMENT_ID"

# Firebase Auth handlers - proxy to Firebase
[[redirects]]
  from = "/__/auth/*"
  to = "https://azimut-kosher-kravi.firebaseapp.com/__/auth/:splat"
  status = 200
  force = true

# SPA fallback - must come after Firebase auth proxies
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
  force = false


[context.deploy-preview]
  environment = { NODE_ENV = "development" }

[context.branch-deploy]
  environment = { NODE_ENV = "development" }